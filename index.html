<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Prove you are not a robot ðŸ¤–ðŸ’œ</title>
  <link href="https://fonts.googleapis.com/css2?family=Baloo+2:wght@700&display=swap" rel="stylesheet">
  <style>
    :root {
      --main-bg: linear-gradient(135deg, #a084e8 0%, #e7bcde 100%);
      --frost-bg: rgba(255,255,255,0.20);
      --frost-border: rgba(255,255,255,0.35);
      --glass-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.17);
      --accent: #e8b3ff;
      --accent-dark: #b488e8;
      --text-glow: 0 0 6px #fff, 0 0 18px #e8b3ff;
      --button-glow: 0 0 15px #e8b3ff, 0 0 40px #b488e8;
    }
    body {
      margin: 0;
      padding: 0;
      min-height: 100vh;
      font-family: 'Baloo 2', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: var(--main-bg);
      position: relative;
      overflow-x: hidden;
      transition: background 1s;
    }
    /* Aurora Effect (unchanged) */
    .aurora {
      position: absolute;
      left: 50%;
      top: 0;
      width: 110vw;
      height: 110px;
      transform: translateX(-50%);
      z-index: 10;
      pointer-events: none;
      overflow: hidden;
    }
    .aurora-gradient {
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, #96fbc4 0%, #f9f586 16%, #fbc2eb 32%, #a084e8 60%, #fbc2eb 80%, #96fbc4 100%);
      opacity: 0.5;
      filter: blur(20px);
      animation: aurora-move 7s linear infinite alternate;
    }
    @keyframes aurora-move {
      0% {transform: translateX(0);}
      100% {transform: translateX(-20vw);}
    }
    .frosted {
      background: var(--frost-bg);
      border: 2.5px solid var(--frost-border);
      box-shadow: var(--glass-shadow);
      backdrop-filter: blur(22px);
      border-radius: 32px;
      padding: 44px 32px 36px 32px;
      max-width: 440px;
      margin: 0 auto;
      margin-top: 9vh;
      text-align: center;
      animation: fadeInUp 1.5s cubic-bezier(0.33,1,0.68,1) both;
      position: relative;
      z-index: 20;
    }
    @keyframes fadeInUp {
      0% { opacity: 0; transform: translateY(60px);}
      100% { opacity: 1; transform: translateY(0);}
    }
    /* Page 1 Fonts and Question */
    .main-question {
      font-family: 'Baloo 2', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      font-size: 2.1em;
      font-weight: 700;
      color: #15111a;
      letter-spacing: 1.5px;
      text-shadow: 0 2px 12px #fff5, 0 1px 0 #fff8;
      margin-bottom: 20px;
      margin-top: 22px;
      line-height: 1.2;
    }
    .dreamy-label {
      color: #15111a;
      font-size: 1.23em;
      letter-spacing: 1px;
      margin-bottom: 12px;
      font-weight: bold;
      text-shadow: 0 0 5px #fff7, 0 0 20px #d8b6ff77;
    }
    input[type="text"] {
      padding: 13px 16px;
      font-size: 1.1em;
      border-radius: 12px;
      border: 1.5px solid #d8b6ff;
      width: 80%;
      margin-bottom: 10px;
      outline: none;
      background: rgba(255,255,255,0.4);
      box-shadow: 0 1px 8px #e8b3ff44;
      transition: border 0.2s;
    }
    input[type="text"]:focus {
      border: 2px solid #e8b3ff;
      background: #fff8;
    }
    button {
      padding: 14px 42px;
      border-radius: 18px;
      background: var(--accent);
      border: none;
      color: #fff;
      font-size: 1.22em;
      letter-spacing: 2px;
      margin-top: 8px;
      font-family: 'Baloo 2', cursive, sans-serif;
      font-weight: 600;
      box-shadow: var(--button-glow);
      cursor: pointer;
      transition: background 0.22s, box-shadow 0.22s;
      text-shadow: 0 0 7px #fff9;
    }
    button:hover, button:active {
      background: var(--accent-dark);
      box-shadow: 0 0 35px #e8b3ff, 0 0 70px #b488e8;
    }
    .success { color: #43a047; margin-top: 10px; font-weight: bold; }
    .error { color: #e53935; margin-top: 10px; font-weight: bold; }
    /* Page 2: Love Story wider text, LAPTOP responsive only */
    .love-story {
      background: rgba(255,255,255,0.18);
      border-radius: 18px;
      padding: 44px 13vw 44px 13vw;
      font-size: 1.17em;
      color: #26132e;
      line-height: 1.7;
      margin-bottom: 28px;
      box-shadow: 0 2px 16px #e7bcde55;
      animation: fadeInUp 1.2s both;
      max-width: none;
      min-width: 1200px;
      white-space: nowrap;
      overflow-x: auto;
      overflow-y: hidden;
      letter-spacing: 0.3px;
      font-weight: 500;
      display: block;
    }
    .love-story > * {
      display: inline;
      white-space: pre;
    }
    /* Hide scroll on smaller screens (disable mobile responsiveness for this page) */
    @media (max-width: 1100px) {
      .love-story { min-width: 900px; padding: 40px 2vw; }
    }
    @media (max-width: 900px) {
      .love-story { min-width: 720px; padding: 30px 1vw; }
    }
    @media (max-width: 700px) {
      .love-story { min-width: 640px; }
    }
    .illustration img {
      width: 52px;
      margin: 0 10px 8px 10px;
      vertical-align: middle;
      filter: drop-shadow(0 2px 4px #fff8);
      animation: float 3s ease-in-out infinite;
    }
    @keyframes float {
      0%, 100% { transform: translateY(0);}
      50% { transform: translateY(-13px);}
    }
    /* Attractive Nickname Captcha */
    .nickname-captcha {
      background: linear-gradient(90deg, #fbc2eb 0%, #a6c1ee 100%);
      border-radius: 12px;
      padding: 20px 14px 16px 14px;
      font-size: 1.2em;
      color: #6a1b9a;
      font-weight: bold;
      margin-bottom: 20px;
      margin-top: 18px;
      box-shadow: 0 4px 18px #e8b3ff44;
      border: 2px solid #e8b3ff77;
      display: inline-block;
      width: 87%;
      letter-spacing: 1px;
      text-shadow: 0 2px 10px #fff5;
    }
    /* Raindrops */
    .raindrop {
      position: fixed;
      z-index: 10000;
      top: -30px;
      width: 7px; height: 16px;
      pointer-events: none;
      border-radius: 80% 80% 60% 60%;
      background: linear-gradient(160deg, #fff 60%, #d8b6ff 100%);
      opacity: 0.38;
      animation: raindrop-fall 5.5s linear forwards;
      box-shadow: 0 7px 18px #fff5;
    }
    @keyframes raindrop-fall {
      0% { opacity: 0; }
      6% { opacity: 0.7;}
      90% { opacity: 0.7;}
      100% { transform: translateY(110vh); opacity: 0;}
    }

    /* --- PAGE 3: PASTEL ROMANTIC POLAROID GAME --- */
    #page3 {
      min-height: 100vh;
      width: 100vw;
      padding: 0;
      margin: 0;
      /* Pastel gradient background */
      background: linear-gradient(120deg, #d1caff 0%, #ffe3e3 50%, #bfeaff 100%);
      position: relative;
      overflow: hidden;
      box-shadow: 0 0 70px #e8b3ff33 inset;
      display: flex;
      align-items: center;
      justify-content: center;
      flex-direction: column;
    }
    .core-memories-container {
      width: 100vw;
      max-width: 100vw;
      margin: 0 auto;
      padding: 0;
      position: relative;
      z-index: 1;
      background: none;
      box-shadow: none;
    }
    .core-title {
      font-family: 'Baloo 2', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      font-size: 2.2em;
      font-weight: 700;
      color: #6a1b9a;
      margin-bottom: 10px;
      letter-spacing: 2px;
      text-shadow: 0 1px 8px #fff6, 0 0 14px #e8b3ff66;
      text-align: center;
    }
    .drag-instructions {
      font-size: 1.07em;
      color: #6a1b9a;
      text-shadow: 0 2px 8px #fff6;
      margin-bottom: 18px;
      font-weight: 600;
      letter-spacing: 1px;
      text-align: center;
      animation: fadeInUp 1.2s both;
    }
    /* Polaroid frames */
    .polaroid-area {
      width: 100vw;
      height: 360px;
      position: relative;
      margin-bottom: 10px;
      z-index: 10;
    }
    .polaroid-frame {
      position: absolute;
      width: 180px;
      height: 210px;
      border-radius: 22px;
      background: rgba(255,255,255,0.26);
      border: 2.5px solid #fff;
      box-shadow: 0 8px 40px #b488e8cc, 0 1.5px 8px #e8b3ff88, 0 0 28px #fff8 inset;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: flex-end;
      transition: box-shadow 0.2s, transform 0.12s;
      overflow: hidden;
      pointer-events: auto;
      /* Glowing floating effect */
      animation: polaroidFloat 6s infinite ease-in-out;
    }
    @keyframes polaroidFloat {
      0%,100% { box-shadow:0 8px 40px #b488e8cc,0 1.5px 8px #e8b3ff88,0 0 28px #fff8 inset; transform:translateY(0); }
      50% { box-shadow:0 20px 60px #b488e8cc,0 1.5px 18px #e8b3ffcc,0 0 50px #fff8 inset; transform:translateY(-12px);}
    }
    .polaroid-label {
      width: 100%;
      text-align: center;
      font-size: 1.05em;
      color: #7b619d;
      font-weight: 700;
      letter-spacing: 1.5px;
      background: rgba(255,255,255,0.72);
      border-top: 1.5px solid #e8b3ff;
      padding: 11px 0 9px 0;
      font-family: 'Baloo 2', cursive, sans-serif;
      text-shadow: 0 1px 8px #e8b3ff44;
      margin-top: auto;
      border-radius: 0 0 18px 18px;
      box-shadow: 0 2px 8px #fff6 inset;
      user-select: none;
    }
    .polaroid-drop {
      width: 100%;
      height: 80%;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: background 0.18s;
      border-radius: 18px 18px 0 0;
      min-height: 135px;
      min-width: 100px;
      pointer-events: auto;
    }
    .polaroid-frame.highlight {
      box-shadow: 0 0 0 6px #e8b3ff66, 0 8px 40px #b488e8cc, 0 1.5px 8px #e8b3ff88;
      background: rgba(255,255,255,0.48);
      transform: scale(1.04);
    }
    /* Place polaroids at visible random spots (non-overlapping) */
    .polaroid-1 { left: 8vw;  top: 32px; }
    .polaroid-2 { left: 26vw; top: 42px; }
    .polaroid-3 { left: 47vw; top: 11px; }
    .polaroid-4 { left: 66vw; top: 44px; }
    .polaroid-5 { left: 83vw; top: 60px; }
    /* Draggable photos */
    .draggable-photos {
      width: 96vw;
      min-width: 980px;
      margin: 0 auto;
      margin-top: 24px;
      display: flex;
      justify-content: space-evenly;
      align-items: flex-end;
      height: 220px;
      position: relative;
      z-index: 12;
      user-select: none;
    }
    .draggable-photo {
      width: 140px;
      height: 170px;
      border-radius: 20px;
      box-shadow: 0 2px 24px #e7bcde66,0 6px 30px #b488e8cc,0 0 18px #fff6;
      background: rgba(255,255,255,0.9);
      overflow: hidden;
      cursor: grab;
      margin: 0 15px;
      position: relative;
      transition: transform 0.13s, box-shadow 0.2s;
      z-index: 20;
      display: flex;
      align-items: flex-end;
      justify-content: center;
      border: 2px solid #e7bcdebb;
    }
    .draggable-photo.dragging {
      opacity: 0.7;
      box-shadow: 0 0 0 10px #e8b3ff66,0 2px 24px #e7bcde99;
      transform: scale(1.07) rotate(-2deg);
      z-index: 99;
      cursor: grabbing;
    }
    .draggable-photo img {
      width: 100%;
      height: auto;
      border-radius: 18px;
      user-drag: none;
      user-select: none;
      pointer-events: none;
    }
    /* Success message */
    .dreamy-message {
      position: absolute;
      left: 50%;
      top: 60%;
      transform: translate(-50%,0);
      font-size: 2.1em;
      color: #fff;
      font-family: 'Baloo 2', cursive, sans-serif;
      text-align: center;
      padding: 28px 40px;
      border-radius: 32px;
      background: linear-gradient(90deg, #e8b3ffcc 0%, #bfeaffbb 100%);
      box-shadow: 0 8px 40px #b488e8cc, 0 1.5px 8px #e8b3ff88;
      text-shadow: 0 0 9px #fff, 0 0 22px #e8b3ff;
      opacity: 0;
      pointer-events: none;
      z-index: 150;
      animation: dreamy-fadein 1.9s cubic-bezier(.64,.11,.39,.97) forwards;
      display: none;
    }
    @keyframes dreamy-fadein {
      0% { opacity: 0; filter: blur(16px);}
      70% { opacity: 0.7;}
      100% { opacity: 1; filter: blur(0);}
    }

    /* --- disable mobile responsiveness for page 3 --- */
    @media (max-width: 1000px) {
      .polaroid-frame, .draggable-photo { width: 110px; height: 120px; }
      .polaroid-area { height: 180px; }
      .draggable-photos { min-width: 500px; }
    }
    @media (max-width: 600px) {
      /* Do not shrink or move polaroids/photos further */
      .polaroid-area, .draggable-photos { min-width: 400px; }
      .core-memories-container { min-width: 400px;}
    }
  </style>
</head>
<body>
  <!-- Aurora -->
  <div class="aurora"><div class="aurora-gradient"></div></div>
  <!-- Page 1: Song Captcha (unchanged) -->
  <div id="page1" style="min-height:100vh;">
    <div class="frosted">
      <div class="main-question">Prove you're not a robot ðŸ¤–ðŸ’œ</div>
      <div class="dreamy-label">What is our common <span style="font-style:italic;">favourite song</span>?</div>
      <input type="text" id="songInp" placeholder="Type here..." autocomplete="off"/>
      <br>
      <button onclick="checkSong()">Submit</button>
      <div id="songResult"></div>
    </div>
  </div>
  <!-- Page 2: Love Story + Nickname Captcha (modified) -->
  <div id="page2" style="display:none; min-height:100vh;">
    <div class="frosted">
      <div class="love-story">
        <div class="illustration">
          <img src="https://em-content.zobj.net/thumbs/120/apple/354/teddy-bear_1f9f8.png" alt="teddy">
          <img src="https://em-content.zobj.net/thumbs/120/apple/354/tulip_1f337.png" alt="tulip">
        </div>
        <h2 style="font-family:'Baloo 2',cursive;font-size:2em;color:#754b9a;">Mohit and Thara ðŸ’•</h2>
        If this page has found you, then my 3 to 4 months of daily coding were truly successful. Because this was made just for you, Sachutty!! Do you remember how we were in the same division in fourth and fifth standard, sat together in the same traveller KRK? And how those senior chechis used to tease us by pretending to marry us by plucking leaves through the traveller window and throwing them on our heads like it was some dramatic ceremony!! We both shouted chii and ran away, laughing and hiding in embarrassment. But little did we know, destiny was smiling quietly that day!! And now here we are in 2025. It has almost been a year since you confessed your love to me!! Since then, everything has changed. You became my constant, my peace, my strongest support!! You stayed with me through every low, held me even when you were tired, and gave me the kind of love that speaks louder in silence than in words!! You stood by me when no one else did. You tried every day to bring even the smallest smile to my face!! I have seen your efforts, I have felt your love, and I hold it close always. And how can I ever forget 7th of July, the evening you proposed with that shy yet brave heart!! And 13th of July, the moment I accepted your request and gave this love a name!! That evening on Snapchat, we were playing Truth or Dare, and I made you say the truth in the most indirect way possible. Even then, you smiled with those shy eyes and said everything without fully saying it!! It was awkward, funny, and somehow deeply beautiful. It felt like our beginning!! Heyy Sachutty, I know things have not been easy for you. But I want you to know this with all my heart!! Your Vaava is always rooting for you. Always cheering for you even when the world gets quiet!! This page is just one percent of my love. The rest is in every look, every prayer, and every tomorrow where I choose you again and again!! In every universe, in every lifetime, itâ€™s still you.
      </div>
      <div class="nickname-captcha">
        <span>âœ¨ Attractive Captcha: <span style="color:#754b9a;">What does Mohit call Thara?</span> âœ¨</span>
        <br><br>
        <input type="text" id="nickInp" placeholder="Enter nickname..." autocomplete="off" style="margin-bottom:6px;width:90%;font-size:1em;"/>
        <br>
        <button onclick="checkNickname()" style="font-size:1em;padding:10px 28px;">Unlock Memories</button>
        <div id="nickResult"></div>
      </div>
    </div>
  </div>
  <!-- Page 3: Polaroid Draggable Game (new) -->
  <div id="page3" style="display:none; min-height:100vh;">
    <div class="core-memories-container">
      <div class="core-title">CORE MEMORIES</div>
      <div class="drag-instructions">Drag each photo to the correct moment ðŸ’œ</div>
      <div class="polaroid-area">
        <div class="polaroid-frame polaroid-1" data-label="7 July">
          <div class="polaroid-drop" data-polaroid="0"></div>
          <div class="polaroid-label">7 July</div>
        </div>
        <div class="polaroid-frame polaroid-2" data-label="12 Sep">
          <div class="polaroid-drop" data-polaroid="1"></div>
          <div class="polaroid-label">12 Sep</div>
        </div>
        <div class="polaroid-frame polaroid-3" data-label="12 Sep">
          <div class="polaroid-drop" data-polaroid="2"></div>
          <div class="polaroid-label">12 Sep</div>
        </div>
        <div class="polaroid-frame polaroid-4" data-label="16 Aug">
          <div class="polaroid-drop" data-polaroid="3"></div>
          <div class="polaroid-label">16 Aug</div>
        </div>
        <div class="polaroid-frame polaroid-5" data-label="blank">
          <div class="polaroid-drop" data-polaroid="4"></div>
          <div class="polaroid-label">&nbsp;</div>
        </div>
      </div>
      <div class="draggable-photos">
        <div class="draggable-photo" draggable="true" data-photo="0"><img src="./assets/mohit_1.png" alt="Memory 1"></div>
        <div class="draggable-photo" draggable="true" data-photo="1"><img src="./assets/mohit_2.png" alt="Memory 2"></div>
        <div class="draggable-photo" draggable="true" data-photo="2"><img src="./assets/mohit_3.png" alt="Memory 3"></div>
        <div class="draggable-photo" draggable="true" data-photo="3"><img src="./assets/mohit_4.png" alt="Memory 4"></div>
        <div class="draggable-photo" draggable="true" data-photo="4"><img src="./assets/mohit_5.png" alt="Memory 5"></div>
      </div>
      <div class="memory-caption" style="display:none;">Your vaava is rooting for you, always have and always will ðŸ’œ</div>
      <div class="dreamy-message" id="dreamyMsg">we don't know where we will end up, but I promise I will always be there for you ðŸ’œ</div>
      <audio autoplay loop>
        <source src="./assets/sweet-love.mp3" type="audio/mp3">
        Your browser does not support the audio element.
      </audio>
    </div>
  </div>
  <script>
    // Page Navigation
    function showPage(id) {
      document.getElementById('page1').style.display = 'none';
      document.getElementById('page2').style.display = 'none';
      document.getElementById('page3').style.display = 'none';
      document.getElementById(id).style.display = 'block';
      // On page 3 show, reset polaroid game
      if(id==="page3" && window.resetPolaroidGame) window.resetPolaroidGame();
    }
    // Song captcha
    function checkSong() {
      const val = document.getElementById('songInp').value.trim().toLowerCase();
      const res = document.getElementById('songResult');
      if(val === "kho gaye") {
        res.textContent = "Correct! ðŸ’œ";
        res.className = "success";
        setTimeout(() => showPage('page2'), 1100);
      } else {
        res.textContent = "Try again! Hint: it's a dreamy song ðŸ’”";
        res.className = "error";
      }
    }
    // Nickname captcha
    function checkNickname() {
      const val = document.getElementById('nickInp').value.trim().toLowerCase();
      const res = document.getElementById('nickResult');
      if(val === "achu") {
        res.textContent = "Perfect! Unlocking memories... ðŸ’•";
        res.className = "success";
        setTimeout(() => showPage('page3'), 1200);
      } else {
        res.textContent = "Nope ðŸ˜” Try again, cutie!";
        res.className = "error";
      }
    }
    // Raindrop Animation for ALL pages (10 drops per 10s)
    function createRaindrop() {
      const drop = document.createElement('div');
      drop.className = 'raindrop';
      drop.style.left = Math.random() * 98 + 'vw';
      drop.style.width = (6 + Math.random()*3) + 'px';
      drop.style.height = (13 + Math.random()*6) + 'px';
      drop.style.opacity = (0.3 + Math.random() * 0.45).toFixed(2);
      drop.style.animationDuration = (5.2 + Math.random()*1.2).toFixed(2) + "s";
      document.body.appendChild(drop);
      setTimeout(()=>{ drop.remove(); }, 6200);
    }
    setInterval(() => { createRaindrop(); }, 1000);

    // --- Polaroid Drag-and-Match Game ---
    (function(){
      // photo-polaroid match order: [7 July, 12 Sep, 12 Sep, 16 Aug, blank]
      const correctMatch = [0, 1, 2, 3, 4];
      let placed = Array(5).fill(null); // placed[i] = photo index or null

      let draggingPhoto = null, offsetX = 0, offsetY = 0, origRect = null, origParent = null, origNext = null;

      function resetPolaroidGame() {
        // Reset all polaroids
        document.querySelectorAll('.polaroid-drop').forEach(drop => drop.innerHTML = "");
        placed = Array(5).fill(null);
        // Reset photos to bar
        const bar = document.querySelector('.draggable-photos');
        document.querySelectorAll('.draggable-photo').forEach((ph,i) => {
          ph.classList.remove('dragging');
          bar.appendChild(ph);
          ph.style.position = '';
          ph.style.left = '';
          ph.style.top = '';
          ph.style.zIndex = 20;
        });
        // Hide message
        document.getElementById('dreamyMsg').style.display = "none";
      }
      window.resetPolaroidGame = resetPolaroidGame;

      // Drag logic for desktop only
      document.querySelectorAll('.draggable-photo').forEach(photo => {
        // Only photo image is draggable
        photo.addEventListener('mousedown', function(e) {
          if(e.target.tagName.toLowerCase() !== 'img') return;
          e.preventDefault();
          draggingPhoto = photo;
          photo.classList.add('dragging');
          origRect = photo.getBoundingClientRect();
          origParent = photo.parentNode;
          origNext = photo.nextSibling;
          // Move to body
          photo.style.position = 'fixed';
          photo.style.left = origRect.left + 'px';
          photo.style.top = origRect.top + 'px';
          photo.style.zIndex = 999;
          offsetX = e.clientX - origRect.left;
          offsetY = e.clientY - origRect.top;

          document.body.appendChild(photo);

          function moveAt(x, y) {
            photo.style.left = (x - offsetX) + 'px';
            photo.style.top = (y - offsetY) + 'px';
          }
          moveAt(e.clientX, e.clientY);

          function onMouseMove(e) { moveAt(e.clientX, e.clientY); }
          document.addEventListener('mousemove', onMouseMove);

          function onMouseUp(e) {
            document.removeEventListener('mousemove', onMouseMove);
            document.removeEventListener('mouseup', onMouseUp);

            // Hit test polaroids
            let dropped = false;
            document.querySelectorAll('.polaroid-drop').forEach((drop, idx) => {
              const rect = drop.getBoundingClientRect();
              if(e.clientX > rect.left && e.clientX < rect.right &&
                 e.clientY > rect.top && e.clientY < rect.bottom) {
                // Snap into polaroid if empty
                if(!drop.hasChildNodes()) {
                  photo.style.position = '';
                  photo.style.left = '';
                  photo.style.top = '';
                  photo.style.zIndex = 20;
                  drop.appendChild(photo);
                  placed[idx] = parseInt(photo.getAttribute('data-photo'));
                  dropped = true;
                }
              }
            });
            if(!dropped) {
              // Return to original bar
              photo.style.position = '';
              photo.style.left = '';
              photo.style.top = '';
              photo.style.zIndex = 20;
              if(origNext) origParent.insertBefore(photo, origNext);
              else origParent.appendChild(photo);
            }
            photo.classList.remove('dragging');
            draggingPhoto = null;

            // Remove highlight
            document.querySelectorAll('.polaroid-frame').forEach(f=>f.classList.remove('highlight'));

            // Update placed array for removed photos
            document.querySelectorAll('.polaroid-drop').forEach((drop, idx)=>{
              if(!drop.hasChildNodes()) placed[idx] = null;
            });
            // Check for win
            if(placed.every((v,i)=>v!==null && v===correctMatch[i])) {
              showDreamyMsg();
            }
          }
          document.addEventListener('mouseup', onMouseUp);
        });
      });

      // Highlight effect for polaroids on dragover
      document.querySelectorAll('.polaroid-drop').forEach((drop, idx) => {
        drop.addEventListener('mouseenter', function() {
          if(draggingPhoto && !drop.hasChildNodes()) {
            drop.parentNode.classList.add('highlight');
          }
        });
        drop.addEventListener('mouseleave', function() {
          drop.parentNode.classList.remove('highlight');
        });
      });

      function showDreamyMsg() {
        const msg = document.getElementById('dreamyMsg');
        msg.style.display = "block";
        msg.style.opacity = 0;
        setTimeout(()=>{ msg.style.opacity = 1; }, 100);
      }

      // Reset game on first show
      window.resetPolaroidGame();

    })();
  </script>
</body>
</html>
